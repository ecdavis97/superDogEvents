<!DOCTYPE html>
<html lang="en">
  <head>
    <title>APP NAME: Coding Challenge by Ethan Davis</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous"/>

    <!--Bootstrap Icons-->
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css"/>

    <!--Dev Icons-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css"/>

    <!--Prism CSS-->
    <link href="/css/prism.css" rel="stylesheet"/>

    <!--Custom CSS-->
    <link href="/css/site.css" rel="stylesheet"/>

    <!--Favicon-->
    <link rel="icon" type="/img/png" href="/img/White logo - no backgroundSQ.png"/>


  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container-fluid">
        <a class="navbar-brand" href="/index.html"
          ><img
            src="/img/White logo - no backgroundSQ.png"
            height="40"
            width="40"
            class="d-inline-block"
          />
          App Name</a
        >
        <!--can add alignment for text depending on logo-->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon-ecd">
            <i class="bi bi-list"></i>
          </span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                     <!--List Items that frame the nav bar links-->
                     <li class="nav-item">
                      <a class="nav-link" href="index.html">Home</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="app.html">The App</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="code.html">The Code</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="https://github.com/ecdavis97/superDogEvents">My Github</a>
                  </li>
          </ul>
        </div>
      </div>
    </nav>

    <main class="content">
      <div class="container mt-5">
        <div class="row">
          <div class="col-12 col-lg-8">
            <pre class="line-numbers">
                    <code class="language-javascript">
                      const events = [
                      {
                        event: "ComicCon",
                        city: "New York",
                        state: "New York",
                        attendance: 240000,
                        date: "06/01/2017",
                      },
                      {
                        event: "ComicCon",
                        city: "New York",
                        state: "New York",
                        attendance: 250000,
                        date: "06/01/2018",
                      },
                      {
                        event: "ComicCon",
                        city: "New York",
                        state: "New York",
                        attendance: 257000,
                        date: "06/01/2019",
                      },
                      {
                        event: "ComicCon",
                        city: "San Diego",
                        state: "California",
                        attendance: 130000,
                        date: "06/01/2017",
                      },
                      {
                        event: "ComicCon",
                        city: "San Diego",
                        state: "California",
                        attendance: 140000,
                        date: "06/01/2018",
                      },
                      {
                        event: "ComicCon",
                        city: "San Diego",
                        state: "California",
                        attendance: 150000,
                        date: "06/01/2019",
                      },
                      {
                        event: "HeroesCon",
                        city: "Charlotte",
                        state: "North Carolina",
                        attendance: 40000,
                        date: "06/01/2017",
                      },
                      {
                        event: "HeroesCon",
                        city: "Charlotte",
                        state: "North Carolina",
                        attendance: 45000,
                        date: "06/01/2018",
                      },
                      {
                        event: "HeroesCon",
                        city: "Charlotte",
                        state: "North Carolina",
                        attendance: 50000,
                        date: "06/01/2019",
                      },
                    ];
                    
                    buildDD();
                    
                    function buildDD() {
                      let eventDD = document.getElementById("eventDropDown");
                      eventDD.innerHTML = "";
                    
                      let ddItemTemplate = document.getElementById("cityDD-template");
                    
                      let ddItemNode = document.importNode(ddItemTemplate.content, true);
                      let ddItem = ddItemNode.querySelector("a");
                      ddItem.textContent = "All";
                      ddItem.setAttribute("data-string", "All");
                      eventDD.appendChild(ddItemNode);
                    
                      let currentEvents = getEventData();
                    
                      let distinctCities = [...new Set(currentEvents.map((event) => event.city))];
                    
                      for (let index = 0; index < distinctCities.length; index++) {
                        let cityName = distinctCities[index];
                        ddItemNode = document.importNode(ddItemTemplate.content, true);
                        ddItem = ddItemNode.querySelector("a");
                        ddItem.textContent = cityName;
                        ddItem.setAttribute("data-string", cityName);
                        eventDD.appendChild(ddItemNode);
                      }
                    
                      displayStats(currentEvents);
                      displayData(currentEvents);
                    }
                    
                    function displayStats(currentEvents) {
                      let total = 0;
                      let average = 0;
                      let most = 0;
                      let least = currentEvents[0].attendance;
                    
                      for (let index = 0; index < currentEvents.length; index++) {
                        let attendance = currentEvents[index].attendance;
                        total += attendance;
                    
                        if (most < attendance) {
                          most = attendance;
                        }
                    
                        if (least > attendance) {
                          least = attendance;
                        }
                        document.getElementById(
                          "statsHeader"
                        ).innerHTML = `Stats for ${currentEvents[index].city}`;
                      }
                      average = total / currentEvents.length;
                                        
                      document.getElementById("total").innerHTML = total.toLocaleString();
                      document.getElementById("most").innerHTML = most.toLocaleString();
                      document.getElementById("least").innerHTML = least.toLocaleString();
                      document.getElementById("average").innerHTML = average.toLocaleString(
                        "en-US",
                        {
                          minimumFractionDigits: 0,
                          maximumFractionDigits: 0,
                        }
                      );
                    }
                    
                    function getEvents(element) {
                      let city = element.getAttribute("data-string");
                    
                      let currentEvents = getEventData();
                    
                      if (city != "All") {
                        currentEvents = currentEvents.filter(function (event) {
                          if (event.city == city) {
                            return event;
                          }
                        });
                      }
                      displayStats(currentEvents);
                      displayData(currentEvents);
                    }
                    
                    function getEventData() {
                      //this will return our event data
                      let currentEvents = JSON.parse(localStorage.getItem("eventData"));
                    
                      if (currentEvents == null) {
                        currentEvents = events;
                        localStorage.setItem("eventData", JSON.stringify(currentEvents));
                      }
                    
                      return currentEvents;
                    }
                    
                    function displayData(currentEvents) {
                      let eventTemplate = document.getElementById("eventData-template");
                      let eventBody = document.getElementById("eventBody");
                      eventBody.innerHTML = "";
                    
                      for (let index = 0; index < currentEvents.length; index++) {
                        let eventNode = document.importNode(eventTemplate.content, true);
                    
                        let eventItems = eventNode.querySelectorAll("td");
                    
                        eventItems[0].textContent = currentEvents[index].event;
                        eventItems[1].textContent = currentEvents[index].city;
                        eventItems[2].textContent = currentEvents[index].state;
                        eventItems[3].textContent =
                          currentEvents[index].attendance.toLocaleString();
                        eventItems[4].textContent = new Date(
                          currentEvents[index].date
                        ).toLocaleDateString();
                    
                        eventBody.appendChild(eventNode);
                      }
                    }
                    
                    function saveEventData() {
                      let currentEvents = getEventData();
                    
                      let eventObj = {
                        event: "",
                        city: "",
                        state: "",
                        attendance: 0,
                        date: "",
                      };
                    
                      eventObj.event = document.getElementById("newEventName").value;
                      eventObj.city = document.getElementById("newEventCity").value;
                    
                      let selectedState = document.getElementById("newEventState");
                      eventObj.state = selectedState.options[selectedState.selectedIndex].text;
                    
                      let attendance = document.getElementById("newEventAttendance").value;
                      attendance = parseInt(attendance);
                      eventObj.attendance = attendance;
                    
                      let eventDate = document.getElementById("newEventDate").value;
                      let formattedDate = `${eventDate} 00:00`;
                      eventObj.date = new Date(formattedDate).toLocaleDateString();
                    
                      currentEvents.push(eventObj);
                    
                      localStorage.setItem("eventData", JSON.stringify(currentEvents));
                    
                      //reset our drop down, displaystats, displaydata.
                      buildDD();
                    }
                    
                    </code>
                </pre>
          </div>
          <div class="col-12 col-lg-4">
            <p class="fw-bold">This code is built with several functions.</p>
            <h5>buildDD()</h5>
            <p>Builds dropdown menu for city selection.</p>
            <h5>displayStats()</h5>
            <p>Does the math for that stats of each city .</p>
            <h5>getEventData()</h5>
            <p>Gets a list of current events stored in an array.</p>
            <h5>getEvents()</h5>
            <p>Write the city stats to a table.</p>
            <h5>getEventData()</h5>
            <p>Get a list of stats for every event in the chosen city</p>
            <h5>displayData()</h5>
            <p>Display the event stats for the city chosen in a table.</p>
            <h5>saveEventData()</h5>
            <p>Save the event data input by the user in an array.</p>
          </div>
        </div>
      </div>
    </main>

    <!--FOOTER SECTION-->
    <footer class="footer">
      <div class="container-fluid">
        <div class="row row-cols-1 row-cols-lg-3 gy-2">
          <div
            class="col order-last order-md-first d-flex justify-content-center justify-content-lg-start"
          >
            <span class="muted"
              >&copy; 2022 Ethan Davis | ethancdavis97@gmail.com</span
            >
          </div>
          <div class="col text-center">
            <div>
              <img src="/img/ethanDavis_colorLogo_Edited.svg" height="75" />
              <!--make a version of logo without the second line-->
            </div>
          </div>
          <div class="col d-flex justify-content-center justify-content-lg-end">
            <div class="row">
              <div class="col social">
                <a href="#"><i class="bi bi-linkedin"></i></a>
              </div>
              <div class="col social">
                <a href="#"><i class="bi bi-twitter"></i></a>
              </div>
              <div class="col social">
                <a href="#"><i class="bi bi-github"></i></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
      crossorigin="anonymous"
    ></script>

    <script src="/js/prism.js"></script>

    <script>
      Prism.plugins.NormalizeWhitespace.setDefaults({
        "remove-trailing": true,
        "remove-indent": true,
        "left-trim": true,
        "right-trim": true,
      });
    </script>
  </body>
</html>
